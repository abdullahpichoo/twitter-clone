<%= turbo_frame_tag "profile-section" do %>
  <div class="d-flex align-items-center gap-3 mt-2 border border-light-subtle border-bottom-0 border-top-0 rounded-0">
    <%= link_to :back, class: "ms-3 fs-4 text-black btn btn-light rounded-circle" do %>
      <i class="bi bi-arrow-left"></i>
    <% end %>
    <h4><%= current_user.display_name %></h4>
  </div>
  <div class="border border-light-subtle border-bottom-0 border-top-0 rounded-0 p-3">
    <div class="username-and-pfp d-flex flex-column align-items-start gap-3 mb-4">
      <div class="w-100 d-flex justify-content-between">
        <div class="pfp">
          <% if current_user.profile_picture.attached? %>
            <%= image_tag(current_user.profile_page_thumbnail, size: '120x120' , class: "rounded-circle") %>
          <% else %>
            <i class="bi bi-person-circle"></i>
          <% end %>
        </div>
        <span>
          <%= button_tag "Edit Profile", data:{"bs-toggle": "modal",  "bs-target": "#editProfileModal"}, class: "fw-bold btn btn-light border border-2 rounded-pill"%>
        </span>
      </div>
    </div>
    <div class="d-flex flex-column text-start mb-3">
      <h4 class="full-name fw-bolder mb-0">
        <%= current_user.display_name %>
      </h4>
      <div class="username fw-light">
        @<%= current_user.username %>
      </div>
    </div>
    <div class="d-flex gap-3 text-start mb-5">
      <div class = "fw-light" >
        <b class= "fw-bold"> 16</b> Following
      </div>
      <div class = "fw-light" >
        <b class= "fw-bold"> 16</b> Followers
      </div>
    </div>
    <div class = "text-start fs-5 fw-bold">Tweets</div>
  </div>
  <%# Modal for Updating Profile %>
  <div class="modal" id="editProfileModal" tabindex="-1" aria-labelledby="regularScreenModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content p-3">
        <button type="button" id = "profileModalCloseBtn" class="btn-close mb-2" data-bs-dismiss="modal" aria-label="Close"></button>
        <%= form_with model: current_user, url: profile_path, html: {method: :put}, data: {controller: "tweet-form"} do |f| %>
          <div class="container ps-5 pe-5">
            <%# Username %>
            <div class="field mb-2">
              <%= f.label :username, class: "fw-bold fs-5 mb-1" %><br />
              <%= f.text_field :username, autofocus: true, autocomplete: "username", class: "form-control form-control-lg" %>
            </div>
            <%# Display Name %>
            <div class="field mb-2">
              <%= f.label :display_name, class: "fw-bold fs-5 mb-1" %><br />
              <%= f.text_field :display_name, autofocus: true, autocomplete: "username", class: "form-control form-control-lg" %>
            </div>
            <%# Profile Picture %>
            <%= f.label :profile_picture, class: "fw-bold fs-5 mb-1" %><br />
            <div class="input-group mb-2">
              <%= f.file_field :profile_picture, class: "form-control form-control-lg" %>
            </div>
            <%# Submit %>
            <div class="actions mt-4 mb-4">
              <%= f.submit "Update Profile", class: "btn btn-lg btn-primary w-100" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
